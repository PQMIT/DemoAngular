<!-- test locale vietnamese datapicker -->
<!-- <div class="grid mt-5">
    <div class="col-12 col-offset-5">
        <h2>Test locale vietnamese</h2>
        <p-datepicker [(ngModel)]="date" />
    </div>
</div> -->
<!-- part1 -->
<div class="block bg-primary p-1 border-round mb-1" *ngIf="shouldRenderCarousel" q>
    <div class="card">
        <!-- Skeleton loader for carousel -->
        <div class="mx-7">
            <p-carousel [value]="movies" *ngIf="isLoading" [numVisible]="5" [numScroll]="2" [circular]="true" [responsiveOptions]="responsiveOptions">
                <!-- Header for the carousel -->
                <ng-template pTemplate="header" class="justify-content-start">
                    <h1 class="mx-3" style="color: #10b981">PHIM MỚI CẬP NHẬT</h1>
                    <div class="flex">
                        <div class="border border-surface-200 dark:border-surface-700 rounded m-1 p-1">
                            <div class="mb-1">
                                <div class="relative mx-auto">
                                    <!-- Skeleton for image -->
                                </div>
                            </div>
                        </div>
                        <div class="border border-surface-200 dark:border-surface-700 roundedm-1 p-1">
                            <div class="mb-1">
                                <div class="relative mx-auto">
                                    <!-- Skeleton for image -->
                                    <p-skeleton size="16rem" styleClass="mr-2"></p-skeleton>
                                </div>
                            </div>
                        </div>
                        <div class="border border-surface-200 dark:border-surface-700 rounded m-1 p-1">
                            <div class="mb-1">
                                <div class="relative mx-auto">
                                    <!-- Skeleton for image -->
                                    <p-skeleton size="16rem" styleClass="mr-2"></p-skeleton>
                                </div>
                            </div>
                        </div>
                        <div class="border border-surface-200 dark:border-surface-700 rounded m-1 p-1">
                            <div class="mb-1">
                                <div class="relative mx-auto">
                                    <!-- Skeleton for image -->
                                    <p-skeleton size="16rem" styleClass="mr-2"></p-skeleton>
                                </div>
                            </div>
                        </div>
                        <div class="border border-surface-200 dark:border-surface-700 rounded m-1 p-1">
                            <div class="mb-1">
                                <div class="relative mx-auto">
                                    <!-- Skeleton for image -->
                                    <p-skeleton size="16rem" styleClass="mr-2"></p-skeleton>
                                </div>
                            </div>
                        </div>
                        <div class="border border-surface-200 dark:border-surface-700 rounded m-1 p-1">
                            <div class="mb-1">
                                <div class="relative mx-auto">
                                    <!-- Skeleton for image -->
                                    <p-skeleton size="16rem" styleClass="mr-2"></p-skeleton>
                                </div>
                            </div>
                        </div>
                    </div>
                </ng-template>
            </p-carousel>
        </div>

        <!-- <p-carousel [value]="movies" *ngIf="!isLoading" [numVisible]="5" [numScroll]="2" [circular]="true" [responsiveOptions]="responsiveOptions" [autoplayInterval]="autoplayInterval"> -->
        <p-carousel [value]="movies" *ngIf="!isLoading" [numVisible]="5" [numScroll]="2" [circular]="true" [responsiveOptions]="responsiveOptions">
            <!-- Header for the carousel -->
            <ng-template pTemplate="header" class="justify-content-start">
                <div class="flex" style="align-items: center; justify-content: space-between">
                    <h1 class="mx-7" style="color: #10b981">PHIM MỚI CẬP NHẬT</h1>
                    <a style="text-decoration: none; color: #10b981; text-transform: uppercase" [routerLink]="['/movieListCategory', 'phim-moi-cap-nhat']" [queryParams]="{ page: 1 }" class="px-7">
                        XEM TẤT CẢ >>>
                    </a>
                </div>
            </ng-template>

            <!-- Template for each item in the carousel -->
            <ng-template let-movie pTemplate="item">
                <!-- Skeleton loader for image -->

                <!-- Main movie card -->
                <div class="border border-surface-200 dark:border-surface-700 rounded m-2 p-2">
                    <div class="mb-1">
                        <div class="relative mx-auto" [routerLink]="['/moviesView', movie.slug]">
                            <!-- Actual image -->
                            <div class="image-container" *ngIf="movie">
                                <img src="{{ movie.poster_url }}" [alt]="movie.name" class="w-full rounded-border custom-image" />
                            </div>
                        </div>
                    </div>

                    <!-- Movie name with skeleton -->
                    <div class="mb-2 font-medium">
                        <!-- <p-skeleton width="10rem" height="1.5rem" *ngIf="!movie"></p-skeleton> -->
                        <div *ngIf="movie" [routerLink]="['/moviesView', movie.slug]">
                            <strong style="cursor: pointer; color: #955151 !important">{{ movie.name }}</strong>
                        </div>
                    </div>

                    <!-- Price and button section -->
                    <div class="flex justify-content-between items-center">
                        <div class="mt-0 font-semibold text-md">
                            <!-- <p-skeleton width="5rem" height="1.5rem" *ngIf="!movie"></p-skeleton> -->
                            <!-- <span *ngIf="movie">{{ "$" + movie.price }}</span> -->
                        </div>
                        <span>
                            <!-- <p-skeleton shape="circle" size="2rem" *ngIf="!movie"></p-skeleton> -->
                            <p-button *ngIf="movie" severity="danger" [outlined]="true" (onClick)="handleLike($event, movies.indexOf(movie), movie)">
                                <i *ngIf="!isStatusLike[movies.indexOf(movie)]" class="pi pi-heart"></i>
                                <i *ngIf="isStatusLike[movies.indexOf(movie)]" class="pi pi-heart-fill"></i>
                            </p-button>
                            <p-button *ngIf="movie" icon="pi pi-shopping-cart" styleClass="ml-2"></p-button>
                        </span>
                    </div>
                </div>
            </ng-template>

            <ng-template pTemplate="footer"> </ng-template>
        </p-carousel>
    </div>
</div>
<!------>
<div *ngIf="isLoading">
    <div class="block bg-primary p-1 border-round mb-1" *ngFor="let i of [1, 2, 3, 4]">
        <div class="flex" style="align-items: center; justify-content: space-between">
            <h1 class="px-7" style="color: #10b981; text-transform: uppercase">Phim lẻ Mới cập nhật</h1>
            <a style="text-decoration: none; color: #10b981; text-transform: uppercase" [routerLink]="['/movieListCategory']" class="px-7">XEM TẤT CẢ >>></a>
        </div>
        <div class="grid nested-grid p-2 mb-2 mx-6">
            <div class="col-3">
                <div class="card1">
                    <div class="card1-image">
                        <p-skeleton size="30rem" styleClass="mx-0"></p-skeleton>
                    </div>
                </div>
            </div>

            <div class="col-9">
                <div class="grid">
                    <div class="col-3">
                        <div class="card2">
                            <p-skeleton size="29rem" styleClass="mr-2"></p-skeleton>
                        </div>
                    </div>
                    <div class="col-3">
                        <div class="card2">
                            <p-skeleton size="29rem" styleClass="mr-2"></p-skeleton>
                        </div>
                    </div>
                    <div class="col-3">
                        <div class="card2">
                            <p-skeleton size="29rem" styleClass="mr-2"></p-skeleton>
                        </div>
                    </div>
                    <div class="col-3">
                        <div class="card2">
                            <p-skeleton size="29rem" styleClass="mr-2"></p-skeleton>
                        </div>
                    </div>
                    <div class="col-3">
                        <div class="card2">
                            <p-skeleton size="29rem" styleClass="mr-2"></p-skeleton>
                        </div>
                    </div>
                    <div class="col-3">
                        <div class="card2">
                            <p-skeleton size="29rem" styleClass="mr-2"></p-skeleton>
                        </div>
                    </div>
                    <div class="col-3">
                        <div class="card2">
                            <p-skeleton size="29rem" styleClass="mr-2"></p-skeleton>
                        </div>
                    </div>
                    <div class="col-3">
                        <div class="card2">
                            <p-skeleton size="29rem" styleClass="mr-2"></p-skeleton>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<!-- part2 -->
<div class="block bg-primary p-1 border-round mb-1" *ngFor="let category of moviesCategories">
    <div class="flex" style="align-items: center; justify-content: space-between">
        <h1 class="px-7" style="color: #10b981; text-transform: uppercase">{{ category.data.titlePage }} Mới cập nhật</h1>
        <a style="text-decoration: none; color: #10b981; text-transform: uppercase" [routerLink]="['/movieListCategory', category.data.type_list]" [queryParams]="{ page: 1 }" class="px-7"
            >XEM TẤT CẢ >>></a
        >
    </div>
    <div class="grid nested-grid p-2 mb-2 mx-6" *ngIf="!isLoading">
        <!-- <div class="col-3">
            <img alt="Card" class="w-full" style="height: 500px" src="{{ movies[0].poster_url }}" />
        </div> -->
        <div class="col-3">
            <div class="card1" [routerLink]="['/moviesView', category.data.items[0]?.slug]">
                <div class="card1-image">
                    <!-- <img src="{{ movies[0]?.poster_url }}" alt="{{ movies[0]?.name }}" /> -->
                    <img [src]="category.data.APP_DOMAIN_CDN_IMAGE + '/' + category.data.items[0].poster_url" alt="{{ category.data.items[0].name }}" />
                </div>
                <div class="card1-content">
                    <h3>{{ category.data.items[0].name }}</h3>
                    <h3>Tác gốc: {{ category.data.items[0]?.origin_name }}</h3>
                    <h3>Xuất bản: {{ category.data.items[0]?.year }}</h3>
                    <h3>SLUG: {{ category.data.items[0]?.slug }}</h3>
                    <p>This is a romantic drama featuring intense relationships and captivating moments.</p>
                </div>
            </div>
        </div>

        <div class="col-9">
            <div class="grid">
                <div class="col-3" *ngFor="let movie of category.data.items.slice(2); let i = index">
                    <div class="card2">
                        <div class="card2-image">
                            <img [src]="'https://phimimg.com/' + movie.poster_url" [alt]="movie.name || 'Movie Poster'" />
                        </div>
                        <div class="card2-content">
                            <p>{{ movie.name }}</p>
                            <p>Tác gốc: {{ movie.origin_name }}</p>
                            <p>Xuất bản: {{ movie.year }}</p>
                            <p>SLUG: {{ category.data.items[0]?.slug }}</p>
                            <p>This is a romantic drama featuring intense relationships and captivating moments.</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
